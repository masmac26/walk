<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Walk</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>Go Outside!</h1>
  
  <!-- Timer Display -->
  <h2 id="timer">00:00:00</h2>
  
  <!-- Buttons -->
  <button id="startWalk" style="background-color: green; color: white; padding: 10px 20px; margin: 5px; border: none; border-radius: 8px; font-size: 16px;">
    ▶️ Start Walk
  </button>

  <button id="pauseWalk" style="background-color: yellow; color: black; padding: 10px 20px; margin: 5px; border: none; border-radius: 8px; font-size: 16px;">
    ⏸️ Pause Walk
  </button>

  <button id="endWalk" style="background-color: red; color: white; padding: 10px 20px; margin: 5px; border: none; border-radius: 8px; font-size: 16px;">
    🛑 End Walk
  </button>

  <p id="challenge"></p>

  <!-- Bottom nav -->
  <div class="navbar">
    <a href="index.html" class="active">🏠 Home</a>
    <a href="journal.html">📖 Journal</a>
    <a href="settings.html">⚙️ Settings</a>
  </div>

  <!-- Timer Script -->
  <script>
  let timerInterval = null;
  let totalSeconds = 0;
  let isPaused = false;

  function updateTimer() {
    let hours = Math.floor(totalSeconds / 3600);
    let minutes = Math.floor((totalSeconds % 3600) / 60);
    let seconds = totalSeconds % 60;

    document.getElementById("timer").textContent =
      String(hours).padStart(2, "0") + ":" +
      String(minutes).padStart(2, "0") + ":" +
      String(seconds).padStart(2, "0");
  }

  // ---- STREAK TRACKER ----
  function updateStreak() {
    const streakDiv = document.getElementById("streak");

    let data = JSON.parse(localStorage.getItem("walkStreak")) || {
      count: 0,
      lastDate: null
    };

    let today = new Date().toDateString();

    if (data.lastDate !== today) {
      if (data.lastDate) {
        let last = new Date(data.lastDate);
        let diff = (new Date(today) - last) / (1000 * 60 * 60 * 24);

        if (diff === 1) {
          data.count += 1; // consecutive day
        } else {
          data.count = 1; // missed a day
        }
      } else {
        data.count = 1; // first ever walk
      }
      data.lastDate = today;
      localStorage.setItem("walkStreak", JSON.stringify(data));
    }

    streakDiv.textContent = "🔥 Streak: " + data.count + " day" + (data.count > 1 ? "s" : "");
  }

  // ---- BUTTONS ----
  document.getElementById("startWalk").onclick = function() {
    if (timerInterval === null) { 
      isPaused = false;
      timerInterval = setInterval(function() {
        if (!isPaused) {
          totalSeconds++;
          updateTimer();
        }
      }, 1000);
      updateStreak(); // update streak when walk starts
    }
  };

  document.getElementById("pauseWalk").onclick = function() {
    if (timerInterval !== null) {
      isPaused = !isPaused;
      this.textContent = isPaused ? "▶️ Resume Walk" : "⏸️ Pause Walk";
    }
  };

  document.getElementById("endWalk").onclick = function() {
    if (timerInterval !== null) {
      clearInterval(timerInterval);
      timerInterval = null;

      let finalTime = document.getElementById("timer").textContent;
      alert("🎉 Congratulations! Your walk today was " + finalTime + " long!");

      totalSeconds = 0;
      isPaused = false;
      updateTimer();
      document.getElementById("pauseWalk").textContent = "⏸️ Pause Walk";
    }
  };

  // initialize
  updateTimer();
  updateStreak();
</script>
<h3 id="streak">🔥 Streak: 0 days</h3>

</body>
</html>
